<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>8-Week Ruck & Strength Tracker</title>
manifest.json
<style>
:root { --primary:#2563eb; --bg:#f8fafc; --card:#fff; --text:#1e293b; --border:#e2e8f0; --success:#10b981; }
body[data-theme="dark"] { --bg:#0f172a; --card:#1e293b; --text:#f8fafc; --border:#334155; }
body { font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif; background-color:var(--bg); color:var(--text); margin:0; padding:0; padding-bottom:120px; }
header { background:var(--primary); color:white; padding:1rem; position:sticky; top:0; z-index:100; display:flex; justify-content:space-between; align-items:center; }
button.toggle-theme { background:white; color:var(--primary); border:none; padding:6px 12px; border-radius:6px; font-weight:600; cursor:pointer; }
.controls { padding:1rem; display:flex; gap:10px; justify-content:space-between; align-items:center; background:white; border-bottom:1px solid var(--border); }
select,input[type="date"] { padding:8px; border:1px solid var(--border); border-radius:6px; font-size:14px; }
.container { max-width:600px; margin:0 auto; padding:1rem; }
.summary-dashboard { display:grid; grid-template-columns:repeat(4,1fr); gap:10px; margin-bottom:15px; }
.summary-card { background:var(--card); border:1px solid var(--border); border-radius:8px; padding:8px; text-align:center; font-size:0.8rem; }
.summary-progress { height:6px; background:#e2e8f0; border-radius:3px; overflow:hidden; margin-top:4px; }
.summary-fill { height:100%; background:var(--success); width:0%; }
.exercise-card { background:var(--card); border-radius:12px; padding:1rem; margin-bottom:1rem; box-shadow:0 1px 3px rgba(0,0,0,0.05); border:1px solid var(--border); }
.exercise-card.completed { border-left:5px solid var(--success); background:#f0fdf4; }
.exercise-header { display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:0.5rem; }
.exercise-name { font-weight:700; font-size:1.1rem; }
.exercise-details { color:#64748b; font-size:0.9rem; margin-bottom:0.5rem; }
.input-group { margin-top:10px; display:flex; gap:10px; }
input[type="text"] { width:100%; padding:8px; border:1px solid var(--border); border-radius:6px; font-size:14px; }
.nav-bar { position:fixed; bottom:0; left:0; right:0; background:white; border-top:1px solid var(--border); padding:1rem; display:flex; justify-content:space-around; max-width:600px; margin:0 auto; }
button.nav-btn { background:var(--primary); color:white; border:none; padding:10px 20px; border-radius:8px; font-weight:600; cursor:pointer; }
.export-btn { margin-top:10px; background:var(--primary); color:white; padding:8px 12px; border:none; border-radius:6px; cursor:pointer; }
.empty-state { text-align:center; padding:2rem; color:#64748b; }
</style>
</head>
<body>
<header>
<div><h1 id="app-title">Training Tracker</h1><div class="subtitle" id="current-date-display">Today</div></div>
<button class="toggle-theme" onclick="toggleTheme()">Dark Mode</button>
</header>
<div class="controls" style="max-width:600px;margin:0 auto;">
<div><label style="font-size:0.8rem;color:#64748b">Start Date:</label><input type="date" id="start-date-picker"></div>
<div><label style="font-size:0.8rem;color:#64748b">Jump to:</label><select id="week-selector"><option value="1">Week 1</option><option value="2">Week 2</option><option value="3">Week 3</option><option value="4">Week 4</option><option value="5">Week 5</option><option value="6">Week 6</option><option value="7">Week 7</option><option value="8">Week 8</option></select></div>
</div>
<div class="container">
<div class="summary-dashboard" id="summary-dashboard"></div>
<button class="export-btn" onclick="exportNotes()">Export Notes</button>
<div id="workout-container"></div>
</div>
<div class="nav-bar"><button class="nav-btn" onclick="changeDay(-1)">← Prev</button><button class="nav-btn" onclick="jumpToToday()">Today</button><button class="nav-btn" onclick="changeDay(1)">Next →</button></div>
<script>
// Full workoutData array (all 8 weeks)
const workoutData = [];
(function generate() {
    const upper = [
        {ex:"Bench Press",set:"4",rep:"5–8",load:"180 lb"},
        {ex:"Pull-ups",set:"4",rep:"4–8",load:"BW"},
        {ex:"BB Row",set:"4",rep:"6–8",load:"Moderate"},
        {ex:"OHP",set:"3",rep:"6–8",load:"95 lb"}
    ];
    const lower = [
        {ex:"Back Squat",set:"3",rep:"5",load:"225 lb"},
        {ex:"Deadlift",set:"3",rep:"3",load:"315 lb"},
        {ex:"Lunges",set:"3",rep:"10/leg",load:"40 lb"},
        {ex:"Plank",set:"3",rep:"60s",load:"BW"}
    ];
    const cond = [
        {ex:"Push-ups",set:"5",rep:"20",load:"BW"},
        {ex:"Air Squats",set:"5",rep:"30",load:"BW"},
        {ex:"KB Swings",set:"4",rep:"25",load:"53 lb"},
        {ex:"Ruck Shuffle",set:"1",rep:"1 mile",load:"45 lb"}
    ];

    for(let w=1; w<=8; w++) {
        // Day 1: Upper
        upper.forEach(u => workoutData.push({w, d:1, focus:"Upper Strength", ex:u.ex, defaultSets: parseInt(u.set), defaultReps: u.rep, defaultLoad: u.load}));
        // Day 2: Short Ruck
        workoutData.push({w, d:2, focus:"Ruck (Short)", ex:"Ruck March", defaultSets: 1, defaultReps: `${3 + (w-1)*0.5} miles`, defaultLoad: "30lb"});
        // Day 3: Lower
        lower.forEach(l => workoutData.push({w, d:3, focus:"Lower Strength", ex:l.ex, defaultSets: parseInt(l.set), defaultReps: l.rep, defaultLoad: l.load}));
        // Day 4: Base Ruck
        workoutData.push({w, d:4, focus:"Ruck (Base)", ex:"Ruck March", defaultSets: 1, defaultReps: `${4 + (w-1)*0.5} miles`, defaultLoad: "30lb"});
        // Day 5: Conditioning
        cond.forEach(c => workoutData.push({w, d:5, focus:"Conditioning", ex:c.ex, defaultSets: parseInt(c.set), defaultReps: c.rep, defaultLoad: c.load}));
        // Day 6: Long Ruck
        workoutData.push({w, d:6, focus:"Ruck (Long)", ex:"Ruck March", defaultSets: 1, defaultReps: `${6 + w} miles`, defaultLoad: "30-45lb"});
        // Day 7: Rest
        workoutData.push({w, d:7, focus:"Recovery", ex:"Mobility / Rest", defaultSets: 1, defaultReps: "30 min", defaultLoad: "-"});
    }
})();

function getSets(uid, defaultSets, defaultReps, defaultLoad) {
    const saved = localStorage.getItem(uid + '_sets');
    if (saved) return JSON.parse(saved);
    const sets = [];
    for (let i = 0; i < defaultSets; i++) {
        sets.push({ reps: defaultReps, load: defaultLoad, done: false });
    }
    return sets;
}


let currentWeek=1,currentDay=1,startDate=new Date();
function toggleTheme(){const body=document.body;const current=body.getAttribute('data-theme');if(current==='dark'){body.removeAttribute('data-theme');localStorage.setItem('theme','light');}else{body.setAttribute('data-theme','dark');localStorage.setItem('theme','dark');}}
if(localStorage.getItem('theme')==='dark'){document.body.setAttribute('data-theme','dark');}
function exportNotes(){let notes='Workout Notes:\\n';for(let i=0;i<localStorage.length;i++){const key=localStorage.key(i);if(key.endsWith('_note')){notes+=key+': '+localStorage.getItem(key)+'\\n';}}const blob=new Blob([notes],{type:'text/plain'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='ruck_notes.txt';a.click();URL.revokeObjectURL(url);}
function updateSummary(){const dashboard=document.getElementById('summary-dashboard');dashboard.innerHTML='';const counts={};for(let w=1;w<=8;w++)counts[w]={total:0,done:0};const dayIdx={};workoutData.forEach(item=>{if(item.w<1||item.w>8)return;const k=`${item.w}-${item.d}`;if(dayIdx[k]===undefined)dayIdx[k]=0;const idx=dayIdx[k]++;const uid=`w${item.w}-d${item.d}-i${idx}`;
    const sets = getSets(uid, item.defaultSets, item.defaultReps, item.defaultLoad);
    sets.forEach(s => {
        counts[item.w].total++;
        if(s.done) counts[item.w].done++;
    });
});for(let w=1;w<=8;w++){const{total,done}=counts[w];const percent=total?Math.round((done/total)*100):0;const card=document.createElement('div');card.className='summary-card';card.innerHTML='Week '+w+'<div class="summary-progress"><div class="summary-fill" style="width:'+percent+'%"></div></div>'+percent+'%';dashboard.appendChild(card);}}
function renderWorkout(){const container=document.getElementById('workout-container');container.innerHTML='';document.getElementById('week-selector').value=currentWeek;document.getElementById('current-date-display').textContent=`Week ${currentWeek} • ${getDayName(currentDay)}`;const daysExercises=workoutData.filter(i=>i.w===currentWeek&&i.d===currentDay);if(daysExercises.length===0){container.innerHTML='<div class="empty-state">No workout scheduled.</div>';return;}daysExercises.forEach((ex,index)=>{const uid=`w${currentWeek}-d${currentDay}-i${index}`;const sets=getSets(uid, ex.defaultSets, ex.defaultReps, ex.defaultLoad);const savedNote=localStorage.getItem(uid+'_note')||'';
    const card=document.createElement('div');card.className='exercise-card';card.id='card-'+uid;
    let setsHtml = '';
    sets.forEach((s, sIdx) => {
        setsHtml += `<div class="set-row" style="display:flex;gap:10px;margin-bottom:8px;align-items:center;">
            <div style="width:30px;text-align:center;font-weight:bold;color:#64748b;">${sIdx+1}</div>
            <input type="text" value="${s.reps}" placeholder="Reps" onchange="updateSet('${uid}',${sIdx},'reps',this.value)" style="width:80px;">
            <input type="text" value="${s.load}" placeholder="Load" onchange="updateSet('${uid}',${sIdx},'load',this.value)" style="flex:1;">
            <input type="checkbox" ${s.done?'checked':''} onchange="updateSet('${uid}',${sIdx},'done',this.checked)" style="width:24px;height:24px;">
            <button onclick="deleteSet('${uid}',${sIdx})" style="background:#ef4444;color:white;border:none;border-radius:4px;width:24px;height:24px;cursor:pointer;display:flex;align-items:center;justify-content:center;">×</button>
        </div>`;
    });
    
    card.innerHTML=`<div class="exercise-header"><div><div class="exercise-name">${ex.ex}</div></div></div>
    <div id="sets-${uid}">${setsHtml}</div>
    <button onclick="addSet('${uid}')" style="background:var(--primary);color:white;border:none;padding:4px 8px;border-radius:4px;font-size:0.8rem;cursor:pointer;margin-bottom:10px;">+ Add Set</button>
    <div class="input-group"><input type="text" placeholder="Notes" value="${savedNote}" oninput="saveNote('${uid}',this.value)"></div>`;container.appendChild(card);});updateSummary();}

function updateSet(uid, setIdx, field, value) {
    const currentSets = JSON.parse(localStorage.getItem(uid + '_sets') || '[]');
    // If we can't find it in local storage, we need to regenerate default state first (edge case but possible)
    if (currentSets.length === 0) {
       // Ideally we'd need the defaults again, but simpler is just to reload the page or handle gracefully.
       // For now, let's assume getSets was called and saved or we can re-derive.
       // Actually, getSets returns the array but doesn't auto-save to LS until modified.
       // So we need to call getSets again to get the base array to modify.
       // To do this properly without passing defaults everywhere, we can look up the exercise in workoutData.
       // But that's slow. Better approach: store initial state if not present.
    }
    // Re-getting state safely:
    let sets = [];
    const saved = localStorage.getItem(uid + '_sets');
    if (saved) {
        sets = JSON.parse(saved);
    } else {
         // Find original defaults
         const parts = uid.split('-'); // w1-d1-i0
         const w = parseInt(parts[0].substring(1));
         const d = parseInt(parts[1].substring(1));
         const i = parseInt(parts[2].substring(1));
         // Need to reconstruct the day index logic or filter again
         const daysExercises = workoutData.filter(item => item.w === w && item.d === d);
         const ex = daysExercises[i];
         sets = getSets(uid, ex.defaultSets, ex.defaultReps, ex.defaultLoad);
    }
    
    sets[setIdx][field] = value;
    localStorage.setItem(uid + '_sets', JSON.stringify(sets));
    renderWorkout(); // Re-render to update UI/Summary
}

function addSet(uid) {
    let sets = [];
    const saved = localStorage.getItem(uid + '_sets');
    if (saved) {
        sets = JSON.parse(saved);
    } else {
         // Same fallback logic
         const parts = uid.split('-'); 
         const w = parseInt(parts[0].substring(1));
         const d = parseInt(parts[1].substring(1));
         const i = parseInt(parts[2].substring(1));
         const daysExercises = workoutData.filter(item => item.w === w && item.d === d);
         const ex = daysExercises[i];
         sets = getSets(uid, ex.defaultSets, ex.defaultReps, ex.defaultLoad);
    }
    // Duplicate last set or add default
    const last = sets[sets.length-1];
    sets.push({ reps: last ? last.reps : '-', load: last ? last.load : '-', done: false });
    localStorage.setItem(uid + '_sets', JSON.stringify(sets));
    renderWorkout();
}

function deleteSet(uid, setIdx) {
     let sets = [];
    const saved = localStorage.getItem(uid + '_sets');
    if (saved) {
        sets = JSON.parse(saved);
    } else {
         // Same fallback logic to ensure we don't delete from empty air
         const parts = uid.split('-'); 
         const w = parseInt(parts[0].substring(1));
         const d = parseInt(parts[1].substring(1));
         const i = parseInt(parts[2].substring(1));
         const daysExercises = workoutData.filter(item => item.w === w && item.d === d);
         const ex = daysExercises[i];
         sets = getSets(uid, ex.defaultSets, ex.defaultReps, ex.defaultLoad);
    }
    sets.splice(setIdx, 1);
    localStorage.setItem(uid + '_sets', JSON.stringify(sets));
    renderWorkout();
}
function saveNote(id,text){localStorage.setItem(id+'_note',text);}
function getDayName(d){const names=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];return names[d-1]||"Day "+d;}
function parseLocal(s){const p=s.split('-');return new Date(p[0],p[1]-1,p[2]);}
function calculateCurrentDay(){const today=new Date();today.setHours(0,0,0,0);const diffTime=today-startDate;let diffDays=Math.floor(diffTime/(1000*60*60*24));if(diffDays<0)diffDays=0;currentWeek=Math.floor(diffDays/7)+1;currentDay=(diffDays%7)+1;if(currentWeek>8)currentWeek=8;if(currentWeek<1)currentWeek=1;}
function jumpToToday(){calculateCurrentDay();renderWorkout();}
function changeDay(offset){currentDay+=offset;if(currentDay>7){currentDay=1;currentWeek++;}else if(currentDay<1){currentDay=7;currentWeek--;}if(currentWeek>8){currentWeek=8;currentDay=7;}if(currentWeek<1){currentWeek=1;currentDay=1;}renderWorkout();}
window.onload=function(){const savedStart=localStorage.getItem('ruckStartDate');const datePicker=document.getElementById('start-date-picker');if(savedStart){startDate=parseLocal(savedStart);datePicker.value=savedStart;}else{const now=new Date();const y=now.getFullYear(),m=String(now.getMonth()+1).padStart(2,'0'),d=String(now.getDate()).padStart(2,'0');const str=`${y}-${m}-${d}`;datePicker.value=str;localStorage.setItem('ruckStartDate',str);startDate=parseLocal(str);}calculateCurrentDay();renderWorkout();if('serviceWorker' in navigator){navigator.serviceWorker.register('service-worker.js');}};
document.getElementById('start-date-picker').addEventListener('change',function(e){localStorage.setItem('ruckStartDate',e.target.value);startDate=parseLocal(e.target.value);calculateCurrentDay();renderWorkout();});
document.getElementById('week-selector').addEventListener('change',function(e){currentWeek=parseInt(e.target.value);currentDay=1;renderWorkout();});
</script>
</body>
</html>
